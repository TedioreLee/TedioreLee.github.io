<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>🌈Hadoop+Ubuntu伪分布式搭建 | 𝒯𝐸𝒟𝐼𝒪𝑅𝐸𝐿𝐸𝐸</title>
<meta name="description" content="“ʏᴏᴜ'ʀᴇ ᴊᴜꜱᴛ ᴀ ꜱᴀᴅ ꜱᴏɴɢ ᴡɪᴛʜ ɴᴏᴛʜɪɴɢ ᴛᴏ ꜱᴀʏ”" />
<link rel="shortcut icon" href="https://iidx.xyz/favicon.ico?v=1569510289944">
<link href="https://cdn.remixicon.com/releases/v1.3.1/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">

<link rel="stylesheet" href="https://iidx.xyz/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="🌈Hadoop+Ubuntu伪分布式搭建 | 𝒯𝐸𝒟𝐼𝒪𝑅𝐸𝐿𝐸𝐸 - Atom Feed" href="https://iidx.xyz/atom.xml">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



  </head>
  <body>
    <div class="site-nav has-cover">
      <div class="head">
  <div class="inner">
    <a class="site-name" href="https://iidx.xyz">
        <span>𝒯𝐸𝒟𝐼𝒪𝑅𝐸𝐿𝐸𝐸</span>
    </a>
    <label class="burger" for="burger"></label>
    <input id="burger" type="checkbox">
    <button class="burger">
      <div>
        <span></span>
        <span></span>
      </div>
    </button>
    <nav class="info_nav">
      
        
          <a href="https://iidx.xyz">Home</a>
        
      
        
          <a href="/archives">Archive</a>
        
      
        
          <a href="/post/about">About</a>
        
      
        
          <a href="/post/friendlink">Friendlink</a>
        
      
        
          <a href="https://one.iidx.xyz" target="_blank">OneDrive</a>
        
      
        
          <a href="http://bt.iidx.xyz" target="_blank">qBittorrent</a>
        
      
    </nav>
  </div>
</div>
    </div>
    <article role="main" class="hentry has-cover">
      
        <div class="entry-cover js-cover" data-src="https://i.loli.net/2019/04/23/5cbebd3f02eb1.png" data-width="900" data-height="423" style="background-image:url(https://i.loli.net/2019/04/23/5cbebd3f02eb1.png); height: 80vw;">
          <h1 class="post-title">🌈Hadoop+Ubuntu伪分布式搭建</h1>
        </div>
      
      <h1 class="entry-title" itemprop="headline">🌈Hadoop+Ubuntu伪分布式搭建</h1>
      <div class="entry-meta">
        <time class="updated" datetime="2018-04-03 15:19:42">2018-04-03</time>
        <span class="author vcard">
          4 min read
        </span>
      </div>
      <div class="post-content yue">
        <blockquote>
<p>School Work</p>
</blockquote>
<!--more-->
<h2 id="前期准备">前期准备</h2>
<p>ubuntu server需要安装好ssh客户端，在<code>/etc/ssh/sshd_config</code>里修改permissionrootlogin参数为yes<br>
这样就可以使用root账户直接登录了<br>
将准备好的jdk和hadoop安装包使用winscp上传到ubuntu里</p>
<h2 id="安装jdk">安装JDK</h2>
<p>解压缩jdk安装包，使用命令<code>tar -zxvf jdk1.8.0_121.tar.gz</code><br>
我解压到的是<code>/home/hadoop/jdk1.8.0_121</code>路径<br>
此处图片<br>
添加jdk环境变量<br>
打开文件<code>vim /etc/profile</code>在末尾加上</p>
<pre><code>export JAVA_HOME=&quot;/home/hadoop/jdk1.8.0_121&quot;
export PATH=$JAVA_HOME/bin:$PATH
</code></pre>
<p>保存并退出，<code>source /etc/profile</code>使其生效<br>
这时输入<code>java -version</code>即可查看到版本信息表示jdk安装成功</p>
<h2 id="安装hadoop">安装hadoop</h2>
<p>解压缩hadoop<code>tar -zxvf hadoop-2.6.4.tar.gz</code><br>
创建存放hadoop文件的目录<code>sudo mkdir /opt/modules</code><br>
将hadoop文件夹的所有者指定为hadoop用户<code>sudo chown -R hadoop:hadoop /opt/modules</code><br>
配置Hadoop环境变量<code>vim /etc/profile</code><br>
末尾加上</p>
<pre><code>export HADOOP_HOME=&quot;/home/hadoop/hadoop.2.6.4&quot;
export PATH=$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$PATH
</code></pre>
<p>保存并退出，<code>source /etc/profile</code>使其生效<br>
<strong>配置 <em>hadoop-env.sh</em>、<em>mapred-env.sh</em>、<em>yarn-env.sh</em>文件的<em>JAVA_HOME</em>参数</strong><br>
编辑</p>
<pre><code>vim  ${HADOOP_HOME}/etc/hadoop/hadoop-env.sh
vim  ${HADOOP_HOME}/etc/hadoop/mapred-env.sh
vim  ${HADOOP_HOME}/etc/hadoop/yarn-env.sh
</code></pre>
<p>创建临时目录：</p>
<pre><code>sudo mkdir -p /opt/data/tmp
</code></pre>
<p>将临时目录的所有者修改为hadoop</p>
<pre><code>sudo chown –R hadoop:hadoop /opt/data/tmp
</code></pre>
<p><em>注：默认的hadoop.tmp.dir是/tmp/hadoop-${user.name},此时有个问题就是NameNode会将HDFS的元数据存储在这个/tmp目录下，如果操作系统重启了，系统会清空/tmp目录下的东西，导致NameNode元数据丢失，是个非常严重的问题，所有我们应该修改这个路径。</em></p>
<p><strong>配置 core-site.xml</strong></p>
<pre><code>&lt;configuration&gt;
&lt;property&gt;
&lt;name&gt;hadoop.tmp.dir&lt;/name&gt;
&lt;value&gt;/opt/data/tmp&lt;/value&gt;?????????
&lt;/property&gt;
&lt;property&gt;
&lt;name&gt;fs.defaultFS&lt;/name&gt;????????????
&lt;value&gt;hdfs://hadoopm:9000&lt;/value&gt;
&lt;/property&gt;
&lt;/configuration&gt;
</code></pre>
<p><img src="https://tedioreleeblog.pek3b.qingstor.com/hadoop-ubuntu%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E6%90%AD%E5%BB%BA/3.png" alt="3"><br>
<strong>配置、格式化、启动HDFS</strong></p>
<pre><code>vim ${HADOOP_HOME}/etc/hadoop/hdfs-site.xml
</code></pre>
<p>添加片段</p>
<pre><code>&lt;property&gt;
       &lt;name&gt;dfs.replication&lt;/name&gt;
       &lt;value&gt;1&lt;/value&gt;
&lt;/property&gt;
</code></pre>
<p><img src="https://tedioreleeblog.pek3b.qingstor.com/hadoop-ubuntu%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E6%90%AD%E5%BB%BA/4.png" alt="4"><br>
dfs.replication配置是HDFS存储时的备份数量，伪分布式环境只有一个节点，所以这里设置为1。<br>
格式化HDFS</p>
<figure data-type="image" tabindex="1"><img src="https://tedioreleeblog.pek3b.qingstor.com/hadoop-ubuntu%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E6%90%AD%E5%BB%BA/5.png" alt="5"></figure>
<pre><code>hdfs namenode –format
</code></pre>
<p>格式化后，查看core-site.xml里hadoop.tmp.dir（本例是/opt/data目录）指定的目录下是否有了dfs目录，如果有，说明格式化成功。</p>
<p><strong>启动NameNode</strong></p>
<pre><code>/sbin/hadoop-daemon.sh start namenode
</code></pre>
<p><strong>启动DataNode</strong></p>
<pre><code>/sbin/hadoop-daemon.sh start datanode
</code></pre>
<p><strong>启动SecondaryNameNode</strong></p>
<pre><code>sbin/hadoop-daemon.sh start secondarynamenode
</code></pre>
<p><strong>JPS命令查看是否已经启动成功，有结果就是启动成功了</strong><br>
<img src="https://tedioreleeblog.pek3b.qingstor.com/hadoop-ubuntu%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E6%90%AD%E5%BB%BA/6.png" alt="6"></p>
<p><strong>配置、启动YARN</strong><br>
默认没有mapred-site.xml文件，但是有个mapred-site.xml.template配置模板文件。复制模板生成mapred-site.xml</p>
<pre><code>cp etc/hadoop/mapred-site.xml.template etc/hadoop/mapred-site.xml
</code></pre>
<p>添加配置如下：</p>
<pre><code>&lt;property&gt;
&lt;name&gt;mapreduce.framework.name&lt;/name&gt;
&lt;value&gt;yarn&lt;/value&gt;
&lt;/property&gt;
</code></pre>
<p>配置yarn-site.xml</p>
<pre><code>
&lt;property&gt;
&lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;
&lt;value&gt;mapreduce_shuffle&lt;/value&gt;
&lt;/property&gt;
&lt;property&gt;
&lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;
&lt;value&gt;bigdata-senior01.chybinmy.com&lt;/value&gt;
 &lt;/property&gt;
</code></pre>
<p><strong>启动Resourcemanager</strong></p>
<pre><code>sbin/yarn-daemon.sh start resourcemanager
</code></pre>
<p><strong>启动nodemanager</strong></p>
<pre><code>sbin/yarn-daemon.sh start nodemanager
</code></pre>
<p>可以看到ResourceManager、NodeManager已经启动成功了。<br>
<img src="https://tedioreleeblog.pek3b.qingstor.com/hadoop-ubuntu%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E6%90%AD%E5%BB%BA/7.png" alt="7"></p>

      </div>
      <div class="entry-block">
        <div class="entry-tags">
          
            <a href="https://iidx.xyz/tag/sYpHDKKCm">
              Bigdata
            </a>
          
        </div>
      </div>
    </article>
    
      <section class="post-section prev-post">
        <div class="inner">
          <h3>前一篇</h3>
          <a href="https://iidx.xyz/post/steam-asf">
            <strong>🌈腾讯云使用ASF云挂卡</strong>
          </a>
        </div>
      </section>
    
    

    <footer class="footer">
  <div class="main">
    <a href="https://iidx.xyz">
      <img class="avatar" src="https://iidx.xyz/images/avatar.png?v=1569510289944" alt="𝒯𝐸𝒟𝐼𝒪𝑅𝐸𝐿𝐸𝐸">
    </a>
    <div class="footer__social">
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    </div>
    <p class="footer__sosumi">
      Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> Published by <a href="https://tediorelee.cn">tediorelee</a> <a href="http://www.miitbeian.gov.cn">蜀ICP备18031601号</a>
    </p>
    <a class="footer-rss" href="https://iidx.xyz/atom.xml">RSS</a>
  </div>
</footer>

<script src="https://iidx.xyz/media/prism.js"></script>
<script>
  Prism.highlightAll()
</script>

  </body>
</html>
